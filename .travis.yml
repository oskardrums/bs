language: rust

# TODO - also test *-musl targets
rust:
    - stable
    - beta
    - nightly

cache:
  directories:
    - /home/travis/.cargo

before_cache:
  - rm -rf /home/travis/.cargo/registry

arch:
    - amd64
    - arm64

script:
  - echo $TRAVIS_RUST_VERSION
  - if [ "$TRAVIS_RUST_VERSION" == "nightly" ];  then cargo build --verbose; cargo test --verbose --all-features ; else cargo build --verbose; cargo test --verbose -p bs -p bs-socket -p bs-filter -p bs-system -p bs-cbpf ; fi

branches:
  only:
  - master